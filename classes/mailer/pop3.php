<?php ${"\x47\x4c\x4fB\x41L\x53"}["\x78\x71q\x6e\x6e\x6bg\x6f\x6d"]="e\x72\x72\x66il\x65";${"\x47L\x4f\x42\x41LS"}["\x74k\x71\x75\x69\x71\x6d\x6e\x73\x6d\x6b\x6b"]="s\x69\x6egl\x65\x5f\x65\x72\x72or";${"\x47L\x4fBAL\x53"}["c\x67\x6c\x62\x78\x61"]="\x70\x6fp\x33\x5f\x72\x65\x73\x70\x6fn\x73e";${"G\x4cOB\x41L\x53"}["\x67\x6d\x63\x70\x78\x63\x68\x62\x76\x68p"]="\x65rr\x73t\x72";${"GLO\x42\x41\x4c\x53"}["q\x72\x61ovz\x72\x6e\x6a\x67"]="er\x72n\x6f";${"\x47LOB\x41LS"}["v\x6a\x77z\x63\x6a\x69"]="p\x6f\x72\x74";${"\x47L\x4f\x42\x41L\x53"}["\x77\x75wf\x70\x6bvx\x79"]="\x6c\x6f\x67i\x6e\x5f\x72\x65s\x75l\x74";${"GL\x4f\x42\x41\x4c\x53"}["\x69hsw\x73\x68\x64\x67"]="re\x73\x75\x6c\x74";${"\x47\x4cO\x42A\x4cS"}["g\x67\x63\x78\x6aw\x72\x6bn\x76\x64"]="p\x61ss\x77o\x72\x64";${"G\x4c\x4fB\x41LS"}["\x67\x6b\x71\x78\x77\x6ak\x77\x6f\x6dk"]="u\x73\x65r\x6eam\x65";${"\x47\x4c\x4f\x42A\x4c\x53"}["d\x78\x79\x6d\x74\x63j"]="\x74\x76\x61\x6c";class Pop3{public$Version='5.2.7';public$POP3_PORT=110;public$POP3_TIMEOUT=30;public$CRLF="\r\n";public$do_debug=0;public$host;public$port;public$tval;public$username;public$password;private$pop_conn;private$connected;private$error;const CRLF="\r\n";public function __construct(){$this->pop_conn=0;$this->connected=false;$this->error=null;}public static function popBeforeSmtp($host,$port=false,$tval=false,$username='',$password='',$debug_level=0){${"GLO\x42\x41\x4c\x53"}["\x64\x79t\x64w\x6f\x6aok\x62\x6f\x61"]="p\x6f\x70";${${"\x47L\x4fB\x41L\x53"}["\x64yt\x64w\x6fjo\x6bboa"]}=new POP3;${"\x47L\x4f\x42\x41\x4c\x53"}["zx\x61\x62\x78\x75\x7a\x68\x64"]="\x70a\x73\x73\x77\x6f\x72\x64";$xjfkgfftmng="\x64\x65bu\x67\x5f\x6c\x65\x76el";$tvbjvwiqe="\x70\x6f\x72\x74";return$pop->authorise($host,${$tvbjvwiqe},${${"\x47\x4cO\x42ALS"}["\x64\x78\x79\x6d\x74c\x6a"]},${${"GLOBALS"}["\x67\x6b\x71\x78\x77j\x6b\x77\x6f\x6d\x6b"]},${${"\x47L\x4fB\x41\x4cS"}["\x7a\x78a\x62\x78\x75zh\x64"]},${$xjfkgfftmng});}public function authorise($host,$port=false,$tval=false,$username='',$password='',$debug_level=0){$yiodwwx="\x74\x76\x61\x6c";${"GL\x4fB\x41\x4cS"}["\x74pn\x68\x79yi\x74g\x68y"]="\x64e\x62\x75\x67_\x6c\x65vel";$this->host=$host;${"\x47\x4c\x4f\x42A\x4c\x53"}["v\x69q\x69p\x71\x65"]="\x70\x6f\x72\x74";if(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["v\x69\x71\x69pq\x65"]}===false){$this->port=$this->POP3_PORT;}else{$rguyrwhlh="\x70or\x74";$this->port=${$rguyrwhlh};}if(${$yiodwwx}===false){$this->tval=$this->POP3_TIMEOUT;}else{$this->tval=${${"G\x4c\x4f\x42\x41LS"}["\x64x\x79\x6dt\x63\x6a"]};}${"G\x4c\x4f\x42A\x4c\x53"}["\x6f\x76\x71o\x68\x78\x6f\x63\x67\x75w\x66"]="\x72e\x73\x75\x6ct";$this->do_debug=${${"GLOBA\x4c\x53"}["\x74\x70\x6e\x68y\x79\x69t\x67\x68\x79"]};$this->username=${${"G\x4c\x4fB\x41\x4c\x53"}["g\x6b\x71\x78wj\x6b\x77\x6f\x6dk"]};$this->password=${${"\x47L\x4f\x42\x41\x4c\x53"}["\x67\x67\x63x\x6a\x77r\x6b\x6e\x76\x64"]};$this->error=null;${${"G\x4cOB\x41\x4c\x53"}["\x6f\x76\x71\x6fh\x78oc\x67\x75w\x66"]}=$this->connect($this->host,$this->port,$this->tval);if(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x69\x68\x73w\x73\x68\x64g"]}){${${"\x47L\x4fB\x41\x4c\x53"}["\x77\x75w\x66\x70\x6b\x76\x78\x79"]}=$this->login($this->username,$this->password);if(${${"\x47LOB\x41\x4cS"}["w\x75w\x66\x70k\x76\x78y"]}){$this->disconnect();return true;}}$this->disconnect();return false;}public function connect($host,$port=false,$tval=30){if($this->connected){return true;}${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6e\x6a\x6cb\x61\x6a\x69"]="\x65r\x72s\x74r";set_error_handler(array($this,"\x63\x61\x74c\x68\x57ar\x6e\x69\x6eg"));$this->pop_conn=fsockopen($host,${${"\x47\x4cO\x42\x41\x4c\x53"}["v\x6awz\x63\x6ai"]},${${"\x47\x4cO\x42\x41LS"}["\x71\x72\x61ovz\x72\x6e\x6a\x67"]},${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6e\x6a\x6c\x62aj\x69"]},${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x64x\x79\x6dtc\x6a"]});restore_error_handler();${"\x47L\x4fBA\x4c\x53"}["\x71\x72s\x6d\x73\x6d"]="pop\x33_\x72\x65s\x70o\x6e\x73\x65";if($this->error&&$this->do_debug>=1){$this->displayErrors();}if($this->pop_conn==false){$this->error=array("e\x72r\x6f\x72"=>"Fa\x69le\x64 \x74o\x20\x63on\x6e\x65c\x74 \x74o \x73\x65r\x76\x65r $host\x20\x6fn p\x6f\x72t $port","e\x72rn\x6f"=>${${"G\x4cOBAL\x53"}["q\x72\x61\x6fvz\x72njg"]},"err\x73\x74\x72"=>${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["gmcpxc\x68b\x76\x68p"]});if($this->do_debug>=1){$this->displayErrors();}return false;}if(version_compare(phpversion(),"5\x2e0.0","ge")){stream_set_timeout($this->pop_conn,${${"\x47\x4cO\x42AL\x53"}["\x64x\x79\x6d\x74\x63\x6a"]},0);}else{if(substr(PHP_OS,0,3)!=="W\x49N"){socket_set_timeout($this->pop_conn,${${"\x47L\x4f\x42\x41\x4c\x53"}["\x64\x78y\x6d\x74c\x6a"]},0);}}${${"\x47\x4cO\x42\x41\x4cS"}["\x71r\x73\x6d\x73\x6d"]}=$this->getResponse();if($this->checkResponse(${${"\x47L\x4f\x42\x41\x4c\x53"}["c\x67\x6c\x62\x78\x61"]})){$this->connected=true;return true;}return false;}public function login($username='',$password=''){$irekeqj="\x75se\x72\x6ea\x6de";if($this->connected==false){$this->error="Not\x20c\x6f\x6ene\x63t\x65\x64 \x74\x6f\x20\x50O\x503\x20s\x65r\x76\x65\x72";if($this->do_debug>=1){$this->displayErrors();}}${"GL\x4f\x42\x41\x4c\x53"}["\x6eg\x6fths\x6c\x79j"]="\x70o\x70\x33\x5f\x72\x65\x73\x70o\x6e\x73e";$rwrbjqazkk="\x70\x61\x73\x73\x77\x6f\x72\x64";if(empty(${$irekeqj})){${${"\x47\x4cO\x42\x41\x4c\x53"}["\x67k\x71x\x77\x6ak\x77\x6f\x6dk"]}=$this->username;}if(empty(${$rwrbjqazkk})){$aixpkncz="p\x61\x73\x73\x77\x6f\x72\x64";${$aixpkncz}=$this->password;}$this->sendString("\x55S\x45R $username".self::CRLF);${${"\x47L\x4fBALS"}["\x6e\x67\x6ft\x68\x73\x6c\x79\x6a"]}=$this->getResponse();if($this->checkResponse(${${"\x47LO\x42\x41\x4c\x53"}["c\x67\x6c\x62\x78\x61"]})){${"GLOB\x41\x4c\x53"}["n\x72x\x66\x6e\x6am\x63e\x6a\x75"]="p\x6f\x70\x33_r\x65\x73\x70o\x6e\x73\x65";$this->sendString("PA\x53S $password".self::CRLF);${${"\x47LOBAL\x53"}["\x63gl\x62xa"]}=$this->getResponse();if($this->checkResponse(${${"\x47LOB\x41\x4cS"}["\x6erx\x66\x6e\x6a\x6dc\x65\x6a\x75"]})){return true;}}return false;}public function disconnect(){$this->sendString("QUI\x54");@fclose($this->pop_conn);}private function getResponse($size=128){${"G\x4c\x4fBAL\x53"}["b\x6bq\x67j\x6d\x67\x6c\x78\x6c"]="\x72e\x73\x70\x6f\x6e\x73e";${"\x47L\x4fB\x41L\x53"}["r\x6f\x78r\x62\x62\x79\x70a\x6d\x78"]="\x73\x69\x7ae";$udwiffyfalov="\x72\x65\x73\x70\x6f\x6e\x73e";${${"\x47L\x4f\x42\x41\x4cS"}["b\x6b\x71\x67j\x6d\x67\x6c\x78l"]}=fgets($this->pop_conn,${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x72o\x78\x72\x62\x62\x79\x70\x61\x6dx"]});if($this->do_debug>=1){echo"S\x65\x72ve\x72\x20->\x20Clien\x74: $response";}return${$udwiffyfalov};}private function sendString($string){if($this->pop_conn){if($this->do_debug>=2){echo"Cl\x69\x65\x6e\x74\x20-> S\x65\x72v\x65r:\x20$string";}${"G\x4cOB\x41\x4c\x53"}["\x71\x73\x67\x6b\x62\x6bgk\x77\x61"]="\x73tri\x6eg";$vmfqonyhhekk="\x73\x74\x72i\x6e\x67";return fwrite($this->pop_conn,${$vmfqonyhhekk},strlen(${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x71s\x67\x6b\x62\x6b\x67\x6bw\x61"]}));}return 0;}private function checkResponse($string){${"\x47\x4cO\x42\x41\x4cS"}["\x67nv\x78z\x6b\x71\x62\x75k\x66"]="s\x74\x72\x69\x6eg";if(substr(${${"\x47\x4c\x4fB\x41L\x53"}["\x67\x6e\x76\x78z\x6bqb\x75\x6bf"]},0,3)!=="+OK"){$this->error=array("\x65\x72r\x6fr"=>"S\x65rv\x65\x72\x20\x72\x65\x70orted \x61\x6e \x65\x72ror:\x20$string","er\x72\x6e\x6f"=>0,"er\x72str"=>"");if($this->do_debug>=1){$this->displayErrors();}return false;}else{return true;}}private function displayErrors(){echo"\x3c\x70\x72e>";foreach($this->error as${${"\x47\x4cO\x42\x41L\x53"}["\x74\x6bq\x75\x69\x71mns\x6d\x6b\x6b"]}){$quaqkbzf="\x73i\x6e\x67le\x5f\x65\x72r\x6f\x72";print_r(${$quaqkbzf});}echo"</p\x72e>";}private function catchWarning($errno,$errstr,$errfile,$errline){${"\x47L\x4f\x42AL\x53"}["byw\x73\x75s\x6efe\x72\x6b"]="e\x72\x72li\x6e\x65";$kpkmkwfks="\x65\x72rstr";$this->error[]=array("\x65\x72\x72\x6fr"=>"\x43\x6fnnec\x74ing\x20to\x20th\x65\x20P\x4f\x503 s\x65\x72\x76\x65\x72\x20\x72\x61\x69\x73\x65d a\x20PHP\x20wa\x72nin\x67: ","\x65\x72\x72no"=>${${"G\x4c\x4f\x42\x41\x4cS"}["\x71\x72\x61o\x76z\x72\x6e\x6a\x67"]},"\x65r\x72\x73\x74\x72"=>${$kpkmkwfks},"er\x72\x66ile"=>${${"\x47L\x4f\x42\x41\x4c\x53"}["xqq\x6e\x6e\x6bgom"]},"er\x72li\x6e\x65"=>${${"\x47\x4cOB\x41\x4c\x53"}["\x62\x79\x77\x73\x75\x73n\x66\x65\x72\x6b"]});}}
?>