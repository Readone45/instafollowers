<?php ${"\x47L\x4f\x42\x41\x4cS"}["yd\x67\x61f\x74\x78d\x77"]="\x72ow";${"\x47\x4cOB\x41\x4c\x53"}["\x71so\x6e\x79\x67\x70\x73"]="p\x61\x73s\x77or\x64";${"\x47\x4c\x4f\x42\x41\x4cS"}["\x7aq\x74\x6aiy\x76\x62\x6e\x6b\x62q"]="\x65m\x61i\x6c";${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6e\x6b\x72\x66\x76\x76zw\x67\x68"]="\x75\x73\x65\x72\x6e\x61\x6d\x65";${"\x47L\x4fBA\x4c\x53"}["\x72\x68\x6c\x72\x76\x6e\x78q\x62"]="d\x62";require_once("\x70as\x73w\x6f\x72\x64\x2e\x70\x68p");class User extends Password{private$_db;function __construct($db){parent::__construct();$this->_db=${${"GL\x4f\x42\x41\x4c\x53"}["r\x68\x6cr\x76\x6e\x78\x71\x62"]};}public function __sleep(){return array();}private function get_user_hash($username){try{${"G\x4c\x4fB\x41\x4c\x53"}["\x68\x75\x73d\x76\x66\x77\x6c"]="\x73\x74\x6d\x74";${${"\x47L\x4f\x42\x41L\x53"}["\x68\x75\x73\x64v\x66\x77l"]}=$this->_db->prepare("\x53\x45L\x45\x43\x54\x20\x70a\x73\x73\x77or\x64,\x20use\x72na\x6d\x65, \x6d\x65mb\x65\x72I\x44 F\x52O\x4d \x6de\x6d\x62\x65\x72s WHERE u\x73e\x72\x6eam\x65\x20=\x20:\x75\x73e\x72n\x61me\x20A\x4eD\x20\x61\x63\x74iv\x65=\x22Yes\x22\x20");$stmt->execute(array("\x75s\x65rn\x61\x6d\x65"=>${${"\x47\x4c\x4fB\x41L\x53"}["n\x6b\x72f\x76\x76zw\x67\x68"]}));return$stmt->fetch();}catch(PDOException$e){echo"\x3c\x70\x20\x63l\x61s\x73\x3d\x22bg-\x64an\x67er\"\x3e".$e->getMessage()."\x3c/p\x3e";}}private function get_email_hash($email){try{${"\x47\x4cO\x42A\x4c\x53"}["\x63\x6btle\x6d\x6b\x69\x75x\x64y"]="s\x74\x6d\x74";${${"\x47\x4cO\x42\x41\x4c\x53"}["ckt\x6c\x65\x6dk\x69\x75x\x64y"]}=$this->_db->prepare("S\x45L\x45CT\x20p\x61\x73sw\x6f\x72\x64,\x20u\x73e\x72na\x6de, \x6dem\x62\x65\x72I\x44, \x65\x6dail \x46\x52O\x4d \x6dem\x62e\x72s \x57\x48\x45\x52\x45 \x65\x6d\x61il \x3d :e\x6d\x61\x69l AND\x20a\x63tiv\x65=\x22Y\x65\x73\" ");$stmt->execute(array("em\x61\x69\x6c"=>${${"\x47\x4cO\x42\x41\x4c\x53"}["zq\x74ji\x79vbn\x6b\x62\x71"]}));return$stmt->fetch();}catch(PDOException$e){echo"\x3cp\x20\x63\x6cas\x73\x3d\"\x62g-\x64a\x6e\x67er\x22\x3e".$e->getMessage()."</p\x3e";}}public function isValidUsername($username){$kajwfsxwg="\x75\x73er\x6e\x61\x6de";${"GL\x4f\x42\x41\x4c\x53"}["\x76m\x78z\x63n\x73p\x79h"]="\x75s\x65r\x6eam\x65";if(strlen(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6ek\x72f\x76v\x7aw\x67\x68"]})<3)return false;if(strlen(${$kajwfsxwg})>17)return false;if(!ctype_alnum(${${"\x47L\x4f\x42\x41\x4c\x53"}["\x76\x6dx\x7ac\x6e\x73\x70\x79\x68"]}))return false;return true;}public function login($username,$password){$uheowblnu="p\x61ss\x77ord";${"\x47\x4c\x4f\x42\x41L\x53"}["g\x6e\x67\x6as\x6d\x6e\x78k"]="\x75se\x72\x6e\x61\x6de";${"\x47L\x4fB\x41L\x53"}["\x6e\x6dk\x75\x66\x73m"]="\x75\x73e\x72\x6eam\x65";if(!$this->isValidUsername(${${"G\x4c\x4f\x42\x41\x4c\x53"}["n\x6dk\x75\x66\x73m"]}))return false;if(strlen(${${"G\x4c\x4fB\x41\x4cS"}["\x71s\x6f\x6e\x79\x67ps"]})<3)return false;${${"G\x4c\x4fBA\x4c\x53"}["\x79d\x67\x61\x66\x74\x78\x64\x77"]}=$this->get_user_hash(${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x67\x6eg\x6a\x73\x6d\x6e\x78\x6b"]});if($this->password_verify(${$uheowblnu},${${"\x47\x4c\x4fB\x41L\x53"}["\x79d\x67\x61\x66tx\x64\x77"]}["\x70\x61\x73sw\x6f\x72\x64"])==1){$upsohim="\x72\x6f\x77";$_SESSION["\x6co\x67ge\x64\x69n"]=true;$_SESSION["username"]=${$upsohim}["us\x65\x72n\x61me"];$_SESSION["\x6d\x65m\x62\x65\x72\x49D"]=${${"\x47\x4c\x4f\x42A\x4c\x53"}["yd\x67af\x74x\x64\x77"]}["m\x65mberID"];return true;}}public function loginEmail($email,$password){${"G\x4c\x4fB\x41\x4c\x53"}["o\x63riew\x67r"]="\x72\x6f\x77";${"G\x4c\x4f\x42\x41\x4c\x53"}["\x71eg\x76c\x71\x6f\x69\x78\x78h\x62"]="e\x6da\x69\x6c";$phvvofggdo="\x70a\x73\x73\x77o\x72\x64";if(!filter_var(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x7aq\x74j\x69\x79\x76\x62\x6ek\x62\x71"]},FILTER_VALIDATE_EMAIL))return false;if(strlen(${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x71\x73o\x6ey\x67p\x73"]})<3)return false;${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6fc\x72i\x65wgr"]}=$this->get_email_hash(${${"\x47\x4c\x4fB\x41L\x53"}["\x71\x65\x67\x76\x63\x71\x6f\x69\x78\x78hb"]});if($this->password_verify(${$phvvofggdo},${${"G\x4c\x4f\x42AL\x53"}["\x79\x64g\x61\x66\x74\x78\x64w"]}["\x70\x61\x73sw\x6frd"])==1){$_SESSION["\x6c\x6fgge\x64\x69\x6e"]=true;${"G\x4c\x4fBAL\x53"}["u\x69\x66ov\x65\x6e\x73\x73"]="\x72\x6f\x77";$_SESSION["u\x73er\x6e\x61m\x65"]=${${"\x47L\x4f\x42\x41L\x53"}["\x75\x69\x66\x6fv\x65ns\x73"]}["\x75\x73\x65\x72name"];$_SESSION["\x6d\x65mbe\x72ID"]=${${"\x47\x4cO\x42\x41\x4c\x53"}["\x79\x64\x67aft\x78\x64\x77"]}["\x6de\x6db\x65rID"];$_SESSION["\x65ma\x69\x6c"]=${${"\x47LO\x42\x41\x4c\x53"}["yd\x67\x61\x66\x74x\x64\x77"]}["\x65m\x61\x69\x6c"];return true;}}}
?>